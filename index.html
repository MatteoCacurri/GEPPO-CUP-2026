<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>GEPPO WORLD CUP 2026</title>

<!-- PWA -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#e8ff00">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="GeppoCup">
<link rel="apple-touch-icon" href="IMG/logo-geppocup.png">

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@400;600;700;800;900&family=Barlow:wght@400;500;600&family=Poppins:wght@400;500;600;700;800&family=Teko:wght@500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="styles.css">
</head>
<body>

<header>
  <div class="logo">
    <img class="logo-mark" src="IMG/logo-geppocup.png" alt="Geppo Cup Logo">
    <div class="logo-copy">
      <span class="logo-main">Geppo World Cup</span>
      <span class="logo-sub">#nonfateveloraccontare</span>
    </div>
  </div>
  <div class="season-tag">2026</div>
</header>

<nav>
  <div class="tab active" data-tab="classifica">Classifica</div>
  <div class="tab" data-tab="partite">Partite</div>
  <div class="tab" data-tab="marcatori">Marcatori</div>
  <div class="tab" data-tab="squadre">Squadre</div>
  <div class="tab" data-tab="finale">Finale</div>
</nav>

<section class="world-hero">
  <article class="hero-main">
    <video class="hero-video" autoplay muted loop playsinline>
      <source src="IMG/clip.mp4" type="video/mp4">
    </video>
    <div class="hero-overlay"></div>
    <div class="hero-content">
      <div class="hero-kicker">STADIO RIPOLI ¬∑ ESTATE 2026</div>
      <h1 class="hero-title">Geppo World Cup 2026</h1>
      <p class="hero-meta">IL TORNEO DI CALCIO A 8 PIU' AMBITO</p>
      <div class="hero-chip-grid">
        <div class="hero-chip">
          <span>Squadre</span>
          <strong id="hero-teams">--</strong>
        </div>
        <div class="hero-chip">
          <span>Partite giocate</span>
          <strong id="hero-played">--</strong>
        </div>
        <div class="hero-chip">
          <span>Gol segnati</span>
          <strong id="hero-goals">--</strong>
        </div>
        <div class="hero-chip">
          <span>Leader</span>
          <strong id="hero-leader">--</strong>
        </div>
      </div>
    </div>
  </article>

  <aside class="hero-covers">
    <figure class="cover-card">
      <img src="IMG/premiazione.jpeg" alt="Premiazione Top Scorer">
      <figcaption>CAPOCANNONIERE GEPPO_CUP_2025</figcaption>
    </figure>
    <figure class="cover-card">
      <img src="IMG/atmosfera.jpeg" alt="L'atmosfera della Geppo Cup">
      <figcaption>L'atmosfera</figcaption>
    </figure>
  </aside>
</section>

<div class="section active" id="classifica">
  <div class="sec-hdr">
    <div class="sec-title">Classifica</div>
    <div class="sec-sub" id="cl-sub">24 nazionali</div>
  </div>
  <div id="cl-content"><div class="loading">Caricamento...</div></div>
</div>

<div class="section" id="partite">
  <div class="sec-hdr"><div class="sec-title">Partite</div></div>
  <div class="pills" id="p-filter"></div>
  <div id="p-content"><div class="loading">Caricamento...</div></div>
</div>

<div class="section" id="marcatori">
  <div class="sec-hdr">
    <div class="sec-title">Marcatori</div>
    <div class="sec-sub" id="m-sub"></div>
  </div>
  <div class="pills" id="m-filter"></div>
  <div id="m-content"><div class="loading">Caricamento...</div></div>
</div>

<div class="section" id="squadre">
  <div class="sec-hdr">
    <div class="sec-title">Squadre</div>
    <div class="sec-sub" id="sq-sub">24 nazionali ¬∑ 6 fasce</div>
  </div>
  <div class="pills" id="sq-filter"></div>
  <div id="sq-content"><div class="loading">Caricamento...</div></div>
</div>

<div class="section" id="finale">
  <div class="sec-hdr"><div class="sec-title">Fase Finale</div></div>
  <div class="pills" id="f-filter"></div>
  <div id="f-content"><div class="loading">Caricamento...</div></div>
</div>

<div class="bot-bar" id="bot-bar">
  <span class="live-dot"></span>
  <span id="bot-txt">Caricamento...</span>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ‚öôÔ∏è  CONFIGURAZIONE ‚Äî inserisci qui i tuoi dati Google Sheet
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const CFG = {
  sheetId:  '1OAuJr6h77tCnQRFx0sRB_Sd20fLaSzQpbUO_VhBhAwQ',   // ID del tuo Google Sheet
  apiKey:   'AIzaSyC6PJ_73qQuCPbdYKanZgnO1n117VLnBv4',    // API Key Google
  refresh:  30,                   // secondi tra un aggiornamento e l'altro
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// FLAGS EMOJI PER NAZIONALI
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const FLAGS = {
  'ARGENTINA':'üá¶üá∑','BRASILE':'üáßüá∑','FRANCIA':'üá´üá∑','SPAGNA':'üá™üá∏',
  'PORTOGALLO':'üáµüáπ','GERMANIA':'üá©üá™','INGHILTERRA':'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø','ITALIA':'üáÆüáπ',
  'OLANDA':'üá≥üá±','URUGUAY':'üá∫üáæ','COLOMBIA':'üá®üá¥','CROAZIA':'üá≠üá∑',
  'MESSICO':'üá≤üáΩ','USA':'üá∫üá∏','SENEGAL':'üá∏üá≥','MAROCCO':'üá≤üá¶',
  'NORVEGIA':'üá≥üá¥','SVIZZERA':'üá®üá≠','GIAPPONE':'üáØüáµ','SCOZIA':'üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø',
  'ECUADOR':'üá™üá®',"COSTA D'AVORIO":'üá®üáÆ','QATAR':'üá∂üá¶','NUOVA ZELANDA':'üá≥üáø'
};

const CONTINENTI = {
  'ARGENTINA':'America','BRASILE':'America','FRANCIA':'Europa','SPAGNA':'Europa',
  'PORTOGALLO':'Europa','GERMANIA':'Europa','INGHILTERRA':'Europa','ITALIA':'Europa',
  'OLANDA':'Europa','URUGUAY':'America','COLOMBIA':'America','CROAZIA':'Europa',
  'MESSICO':'America','USA':'America','SENEGAL':'Africa','MAROCCO':'Africa',
  'NORVEGIA':'Europa','SVIZZERA':'Europa','GIAPPONE':'Asia','SCOZIA':'Europa',
  'ECUADOR':'America',"COSTA D'AVORIO":'Africa','QATAR':'Asia','NUOVA ZELANDA':'Oceania'
};

const FASCIA_COLORS = {
  1:'#e8ff00',2:'#00d4ff',3:'#00e676',4:'#ff9800',5:'#e040fb',6:'#ff6b6b'
};
const FASCIA_NAMES = {
  1:'Elite ‚≠ê‚≠ê',2:'Forti ‚≠ê',3:'Buone',4:'Medie',5:'Outsider',6:'Wildcard'
};

// Squadre escluse dal torneo
const EXCLUDED_TEAMS = new Set([]);
const normalizeTeam = (name='') => String(name).trim().toUpperCase();
const isExcludedTeam = (name='') => EXCLUDED_TEAMS.has(normalizeTeam(name));
const hasExcludedTeam = (...teams) => teams.some(t => t && t !== 'TBD' && isExcludedTeam(t));

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DATI DEMO ‚Äî 24 squadre reali, calendario generato
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DEMO_SQUADRE = [
  {"nome":"ARGENTINA","fascia":1},{"nome":"BRASILE","fascia":1},
  {"nome":"FRANCIA","fascia":1},{"nome":"SPAGNA","fascia":1},
  {"nome":"PORTOGALLO","fascia":2},{"nome":"GERMANIA","fascia":2},
  {"nome":"INGHILTERRA","fascia":2},{"nome":"ITALIA","fascia":2},
  {"nome":"OLANDA","fascia":3},{"nome":"URUGUAY","fascia":3},
  {"nome":"COLOMBIA","fascia":3},{"nome":"CROAZIA","fascia":3},
  {"nome":"MESSICO","fascia":4},{"nome":"USA","fascia":4},
  {"nome":"SENEGAL","fascia":4},{"nome":"MAROCCO","fascia":4},
  {"nome":"NORVEGIA","fascia":5},{"nome":"SVIZZERA","fascia":5},
  {"nome":"GIAPPONE","fascia":5},{"nome":"SCOZIA","fascia":5},
  {"nome":"ECUADOR","fascia":6},{"nome":"COSTA D'AVORIO","fascia":6},
  {"nome":"QATAR","fascia":6},{"nome":"NUOVA ZELANDA","fascia":6}
];

const DEMO_CLASSIFICA = DEMO_SQUADRE.map((s,i) => ({
  ...s, g:0, v:0, n:0, p:0, gf:0, gs:0, diff:'0', pts:0
}));

const DEMO_PARTITE = [];

const DEMO_MARCATORI = [];

const DEMO_FINALE = {
  mondiale:  { campione:'', quarti:[], semi:[], finale:[] },
  argento:   { campione:'', quarti:[], semi:[], finale:[] },
  bronzo:    { campione:'', quarti:[], semi:[], finale:[] },
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let DATA = null;
let isDemo = true;
let filterP  = 'tutti';
let filterM  = 'tutti';
let filterSq = 'tutti';
let filterF  = 'mondiale';

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// GOOGLE SHEETS FETCH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
async function sheetFetch(range) {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${CFG.sheetId}/values/${encodeURIComponent(range)}?key=${CFG.apiKey}`;
  const r = await fetch(url);
  if (!r.ok) throw new Error('Sheet error ' + r.status);
  const j = await r.json();
  return j.values || [];
}

function parseClassifica(rows) {
  // Sheet: POS | SQUADRA | F | G | V | N | P | GF | GS | DR
  return rows.slice(1).filter(r=>r[1] && !isNaN(+r[0]) && !isExcludedTeam(r[1])).map(r => {
    const v=+r[4]||0, n=+r[5]||0;
    return {
      nome: r[1], fascia: +r[2]||1,
      g:+r[3]||0, v, n, p:+r[6]||0,
      gf:+r[7]||0, gs:+r[8]||0, diff:r[9]||'0', pts: v*3 + n
    };
  });
}

function parsePartite(rows) {
  // Sheet: GG | DATA | CASA | GOL | : | GOL | TRASFERTA | NOTE
  // Separator rows (‚ö° GIORNATA...) have only 1 cell, filtered by r[2]
  return rows.slice(1).filter(r=>r[2] && !isNaN(+r[0]) && !hasExcludedTeam(r[2], r[6])).map(r => ({
    giornata:+r[0]||1, data:r[1]||'', casa:r[2]||'',
    gol_casa:r[3], gol_trasf:r[5], trasferta:r[6]||'', note:r[7]||''
  }));
}

function parseMarcatori(rows) {
  // Sheet: # | NOME GIOCATORE | NAZIONALE | GOL
  return rows.slice(1).filter(r=>r[1] && !isExcludedTeam(r[2])).map(r => ({
    nome:r[1], squadra:r[2]||'', gol:+r[3]||0
  })).sort((a,b)=>b.gol-a.gol);
}

function parseFinale(rows) {
  const out = {
    mondiale:{campione:'',quarti:[],semi:[],terzo:[],finale:[]},
    argento:{campione:'',quarti:[],semi:[],finale:[]},
    bronzo:{campione:'',quarti:[],semi:[],finale:[]}
  };
  rows.slice(1).forEach(r => {
    const fase = (r[0]||'').toLowerCase();
    const comp = (r[5]||'').toLowerCase();
    const m = {s1:r[1]||'TBD',g1:r[2],s2:r[3]||'TBD',g2:r[4]};
    const key = comp.includes('argento') ? 'argento' : comp.includes('bronzo') ? 'bronzo' : 'mondiale';
    if (fase.includes('campio')) {
      out[key].campione = isExcludedTeam(r[1]) ? '' : (r[1]||'');
      return;
    }
    if (hasExcludedTeam(m.s1, m.s2)) return;
    if (fase.includes('quart'))  out[key].quarti.push(m);
    else if (fase.includes('semi')) out[key].semi.push(m);
    else if (fase.includes('3¬∞') || fase.includes('terzo')) out[key].terzo = [m];
    else if (fase.includes('final')) out[key].finale.push(m);
  });
  return out;
}

async function loadFromSheet() {
  const [clRaw, pRaw, mRaw, fRaw] = await Promise.all([
    sheetFetch('Classifica!A:J'),
    sheetFetch('Risultati!A:H'),
    sheetFetch('Marcatori!A:D'),
    sheetFetch('Fase Finale!A:F'),
  ]);
  const classifica = parseClassifica(clRaw);
  const squadre = classifica.map(s => ({nome:s.nome, fascia:s.fascia}));
  return {
    classifica,
    squadre,
    partite: parsePartite(pRaw),
    marcatori: parseMarcatori(mRaw),
    finale: parseFinale(fRaw),
  };
}

async function loadData() {
  isDemo = CFG.sheetId === 'TUO_SHEET_ID_QUI';
  if (isDemo) {
    DATA = { classifica:DEMO_CLASSIFICA, squadre:DEMO_SQUADRE, partite:DEMO_PARTITE, marcatori:DEMO_MARCATORI, finale:DEMO_FINALE };
  } else {
    try {
      DATA = await loadFromSheet();
    } catch(e) {
      DATA = { classifica:DEMO_CLASSIFICA, squadre:DEMO_SQUADRE, partite:DEMO_PARTITE, marcatori:DEMO_MARCATORI, finale:DEMO_FINALE };
      isDemo = true;
    }
  }
  render();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const flag = n => FLAGS[n] || 'üè≥Ô∏è';
const fc   = n => {
  const sq = DATA.squadre.find(s=>s.nome===n);
  return sq ? FASCIA_COLORS[sq.fascia] : '#888';
};
const fascia = n => {
  const sq = DATA.squadre.find(s=>s.nome===n);
  return sq ? sq.fascia : 0;
};

function fmtDate(d) {
  try {
    // Handle both DD/MM/YYYY and YYYY-MM-DD formats
    let date;
    if (d.includes('/')) {
      const [day, month, year] = d.split('/');
      date = new Date(+year, +month-1, +day);
    } else {
      date = new Date(d+'T00:00:00');
    }
    return date.toLocaleDateString('it-IT',{weekday:'short',day:'numeric',month:'short'});
  } catch { return d; }
}

function groupBy(arr, fn) {
  return arr.reduce((a,x) => { const k=fn(x); (a[k]=a[k]||[]).push(x); return a; }, {});
}


function renderHeroStats() {
  const setTxt = (id, value) => {
    const el = document.getElementById(id);
    if (el) el.textContent = value;
  };

  const teamsCount = DATA?.squadre?.length || 0;
  const matches = DATA?.partite || [];
  const played = matches.filter(m =>
    m.gol_casa!==undefined && m.gol_casa!==null && m.gol_casa!=='' &&
    m.gol_trasf!==undefined && m.gol_trasf!==null && m.gol_trasf!==''
  ).length;
  const goals = matches.reduce((sum,m) => sum + (+m.gol_casa||0) + (+m.gol_trasf||0), 0);

  const leader = [...(DATA?.classifica || [])]
    .sort((a,b) => b.pts-a.pts || b.gf-a.gf || a.gs-b.gs)[0]?.nome || 'TBD';

  setTxt('hero-teams', teamsCount);
  setTxt('hero-played', `${played}/${matches.length}`);
  setTxt('hero-goals', goals);
  setTxt('hero-leader', leader);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER CLASSIFICA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderClassifica() {
  const sorted = [...DATA.classifica].sort((a,b) => b.pts-a.pts || b.gf-a.gf || a.gs-b.gs);
  const el = document.getElementById('cl-content');

  let rows = '';
  sorted.forEach((t, i) => {
    const pos = i+1;
    const posCls = pos===1?'p1':pos===2?'p2':pos===3?'p3':'';
    const color = FASCIA_COLORS[t.fascia] || '#888';

    // Separator rows
    if (pos===9)  rows += `<tr class="sep-row"><td colspan="10"><span class="sep-label" style="color:var(--silver)">ü•à COPPA D'ARGENTO ‚Äî 9¬∞-16¬∞ posto</span></td></tr>`;
    if (pos===17) rows += `<tr class="sep-row"><td colspan="10"><span class="sep-label" style="color:var(--bronze)">ü•â COPPA DI BRONZO ‚Äî 17¬∞-24¬∞ posto</span></td></tr>`;

    rows += `<tr>
      <td>
        <div class="team-cell">
          <div class="pos-b ${posCls}">${pos}</div>
          <div class="flag">${flag(t.nome)}</div>
          <div>
            <div class="tname">${t.nome}</div>
          </div>
        </div>
      </td>
      <td><div class="fascia-dot" style="background:${color};margin:0 auto"></div></td>
      <td>${t.g}</td>
      <td style="color:var(--green)">${t.v}</td>
      <td>${t.n}</td>
      <td style="color:var(--red)">${t.p}</td>
      <td>${t.gf}</td>
      <td>${t.gs}</td>
      <td>${t.diff}</td>
      <td><span class="pts-num">${t.pts}</span></td>
    </tr>`;
  });

  el.innerHTML = `
  <div class="cl-wrap">
  <table class="cl-table">
    <thead><tr>
      <th>Squadra</th><th>F</th><th>G</th>
      <th style="color:var(--green)">V</th><th>N</th><th style="color:var(--red)">P</th>
      <th>GF</th><th>GS</th><th>DR</th>
      <th style="color:var(--acc)">PTS</th>
    </tr></thead>
    <tbody>${rows}</tbody>
  </table>
  </div>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER PARTITE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderPartite() {
  const teams = [...new Set(DATA.partite.flatMap(m=>[m.casa,m.trasferta]))].sort();
  const ggg   = [...new Set(DATA.partite.map(m=>'G'+m.giornata))].sort();
  const opts  = ['tutti', ...ggg, ...teams];
  const pills = document.getElementById('p-filter');
  pills.innerHTML = opts.map(o =>
    `<div class="pill ${o===filterP?'active':''}" data-val="${o}">${o==='tutti'?'Tutte':o}</div>`
  ).join('');
  pills.querySelectorAll('.pill').forEach(p => p.addEventListener('click', () => {
    filterP = p.dataset.val; renderPartite();
  }));

  let matches = DATA.partite;
  if (filterP.startsWith('G') && /^G\d+$/.test(filterP)) {
    const gg = +filterP.slice(1);
    matches = matches.filter(m => m.giornata === gg);
  } else if (filterP !== 'tutti') {
    matches = matches.filter(m => m.casa===filterP || m.trasferta===filterP);
  }

  const grouped = groupBy(matches, m=>m.data);
  const dates = Object.keys(grouped).sort((a,b) => {
    // Handle both DD/MM/YYYY and YYYY-MM-DD
    const toISO = s => s.includes('/') ? s.split('/').reverse().join('-') : s;
    return toISO(a).localeCompare(toISO(b));
  });

  const html = dates.map(d => {
    const ms = grouped[d].map(m => {
      const played = m.gol_casa!==undefined && m.gol_casa!==null && m.gol_casa!=='';
      const scoreTxt = played ? `${m.gol_casa} - ${m.gol_trasf}` : 'vs';
      const scoreCls = played ? '' : 'tbd';
      const colorC = fc(m.casa), colorT = fc(m.trasferta);
      const detail = m.note ? `<div class="m-meta"><span>üìç ${m.note}</span></div>` : '';
      return `<div class="match-card">
        <div class="match-row">
          <div class="m-team-l"><span>${m.casa}</span><span>${flag(m.casa)}</span></div>
          <div class="m-score ${scoreCls}">${scoreTxt}</div>
          <div class="m-team-r"><span>${flag(m.trasferta)}</span><span>${m.trasferta}</span></div>
        </div>${detail}
      </div>`;
    }).join('');
    return `<div class="date-grp">
      <div class="date-lbl">‚ö° ${fmtDate(d)}</div>
      ${ms}
    </div>`;
  }).join('');

  document.getElementById('p-content').innerHTML = html || '<p style="color:var(--muted);text-align:center;padding:2rem">Nessuna partita trovata</p>';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER MARCATORI
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderMarcatori() {
  const teams = [...new Set(DATA.marcatori.map(m=>m.squadra))].sort();
  const pills = document.getElementById('m-filter');
  pills.innerHTML = ['tutti',...teams].map(t =>
    `<div class="pill ${t===filterM?'active':''}" data-val="${t}">${t==='tutti'?'Tutti':t}</div>`
  ).join('');
  pills.querySelectorAll('.pill').forEach(p => p.addEventListener('click', () => {
    filterM = p.dataset.val; renderMarcatori();
  }));

  let sc = DATA.marcatori;
  if (filterM !== 'tutti') sc = sc.filter(s=>s.squadra===filterM);
  document.getElementById('m-sub').textContent = sc.length + ' giocatori';
  const max = sc[0]?.gol || 1;

  if (sc.length === 0) {
    document.getElementById('m-content').innerHTML = `<div class="demo-notice">‚öΩ Nessun marcatore inserito ancora.<br>Aggiungi i gol nel foglio Google ‚Üí sheet "Marcatori"</div>`;
    return;
  }

  document.getElementById('m-content').innerHTML = sc.map((s,i) => {
    const rCls = i===0?'r1':i===1?'r2':i===2?'r3':'';
    const pct = Math.round(s.gol/max*100);
    const color = fc(s.squadra);
    return `<div class="scorer" style="animation-delay:${i*.03}s">
      <div class="sc-rank ${rCls}">${i+1}</div>
      <div class="flag">${flag(s.squadra)}</div>
      <div class="sc-info">
        <div class="sc-name">${s.nome}</div>
        <div class="sc-team" style="color:${color}">${s.squadra}</div>
      </div>
      <div class="sc-bar-wrap">
        <div class="sc-bar"><div class="sc-bar-fill" style="width:${pct}%;background:${color}"></div></div>
      </div>
      <div class="sc-gol">
        <div class="gol-n" style="color:${color}">${s.gol}</div>
        <div class="gol-l">GOL</div>
      </div>
    </div>`;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER SQUADRE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderSquadre() {
  const pills = document.getElementById('sq-filter');
  const opts = ['tutti','Fascia 1','Fascia 2','Fascia 3','Fascia 4','Fascia 5','Fascia 6',
    'Europa','America','Asia','Africa','Oceania'];
  pills.innerHTML = opts.map(o =>
    `<div class="pill ${o===filterSq?'active':''}" data-val="${o}">${o==='tutti'?'Tutte':o}</div>`
  ).join('');
  pills.querySelectorAll('.pill').forEach(p => p.addEventListener('click', () => {
    filterSq = p.dataset.val; renderSquadre();
  }));

  const statsMap = {};
  DATA.classifica.forEach(t => { statsMap[t.nome]=t; });

  let sq = DATA.squadre;
  if (filterSq !== 'tutti') {
    if (filterSq.startsWith('Fascia')) {
      const f = +filterSq.split(' ')[1];
      sq = sq.filter(s=>s.fascia===f);
    } else {
      sq = sq.filter(s=>CONTINENTI[s.nome]===filterSq);
    }
  }

  document.getElementById('sq-content').innerHTML = sq.map((s,i) => {
    const color = FASCIA_COLORS[s.fascia];
    const st = statsMap[s.nome]||{};
    return `<div class="sq-card" style="animation-delay:${i*.03}s">
      <div class="sq-flag">${flag(s.nome)}</div>
      <div class="sq-info">
        <div class="sq-name">${s.nome}</div>
        <div class="sq-meta">
          <span class="f-badge" style="background:${color}22;color:${color};border:1px solid ${color}44">F${s.fascia} ¬∑ ${FASCIA_NAMES[s.fascia]}</span>
          <span>${CONTINENTI[s.nome]||''}</span>
        </div>
      </div>
      <div class="sq-stats">
        <div class="stat-m"><div class="v">${st.g||0}</div><div class="l">Part</div></div>
        <div class="stat-m"><div class="v" style="color:var(--acc)">${st.pts||0}</div><div class="l">Pts</div></div>
        <div class="stat-m"><div class="v">${st.gf||0}</div><div class="l">Gol</div></div>
      </div>
    </div>`;
  }).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER FINALE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderFinale() {
  const COMPS = [
    {key:'mondiale', label:'üåç Mondiale', cls:'mondiale', icon:'üèÜ', trophyColor:'var(--acc)'},
    {key:'argento',  label:'ü•à Coppa d\'Argento', cls:'argento', icon:'ü•à', trophyColor:'var(--silver)'},
    {key:'bronzo',   label:'ü•â Coppa di Bronzo', cls:'bronzo', icon:'ü•â', trophyColor:'var(--bronze)'},
  ];

  const pills = document.getElementById('f-filter');
  pills.innerHTML = COMPS.map(c =>
    `<div class="pill ${c.key===filterF?'active':''}" data-val="${c.key}">${c.label}</div>`
  ).join('');
  pills.querySelectorAll('.pill').forEach(p => p.addEventListener('click', () => {
    filterF = p.dataset.val; renderFinale();
  }));

  const comp = COMPS.find(c=>c.key===filterF);
  const fin = DATA.finale[filterF];
  let html = '';

  // Banner campione
  if (fin.campione) {
    html += `<div class="troph-banner ${comp.cls}" data-icon="${comp.icon}">
      <div class="t-label">${comp.icon} Campione</div>
      <div class="t-name">${flag(fin.campione)} ${fin.campione}</div>
    </div>`;
  }

  function renderRound(label, matches) {
    if (!matches || matches.length === 0) return '';
    const ms = matches.map(m => {
      const played = m.g1!==''&&m.g1!==undefined&&m.g1!==null&&m.s1!=='TBD';
      const isTbd1 = !m.s1 || m.s1==='TBD';
      const isTbd2 = !m.s2 || m.s2==='TBD';
      const w1 = played && +m.g1 > +m.g2;
      const w2 = played && +m.g2 > +m.g1;
      const c1 = isTbd1 ? 'var(--muted)' : fc(m.s1);
      const c2 = isTbd2 ? 'var(--muted)' : fc(m.s2);
      return `<div class="br-match">
        <div class="br-team ${w1?'winner':''} ${isTbd1?'tbd-t':''}" style="${w1?`color:${c1}`:''}">
          <span>${isTbd1?'':flag(m.s1)} ${m.s1||'TBD'}</span>
          <span class="br-score">${played?m.g1:''}</span>
        </div>
        <div class="br-team ${w2?'winner':''} ${isTbd2?'tbd-t':''}" style="${w2?`color:${c2}`:''}">
          <span>${isTbd2?'':flag(m.s2)} ${m.s2||'TBD'}</span>
          <span class="br-score">${played?m.g2:''}</span>
        </div>
      </div>`;
    }).join('');
    return `<div class="round-section">
      <div class="round-lbl">${label}</div>
      ${ms}
    </div>`;
  }

  html += renderRound('Quarti di Finale', fin.quarti);
  html += renderRound('Semifinali', fin.semi);
  if (filterF==='mondiale') html += renderRound('3¬∞ Posto', fin.terzo||[]);
  html += renderRound('Finale', fin.finale);

  if (!fin.campione && !fin.quarti?.length && !fin.semi?.length && !fin.finale?.length) {
    html += `<div style="text-align:center;padding:2.5rem 1rem;color:var(--muted);
      font-family:'Barlow Condensed',sans-serif;text-transform:uppercase;
      letter-spacing:.1em;font-size:.9rem">
      Il girone deve ancora terminare<br>
      <span style="font-size:.75rem;margin-top:.5rem;display:block">Le squadre qualificate appariranno qui</span>
    </div>`;
  }

  document.getElementById('f-content').innerHTML = html;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER ALL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function render() {
  renderClassifica();
  renderPartite();
  renderMarcatori();
  renderSquadre();
  renderFinale();
  renderHeroStats();

  const teamsCount = DATA?.squadre?.length || 0;
  const fasceCount = new Set((DATA?.squadre || []).map(s => s.fascia)).size;
  document.getElementById('cl-sub').textContent = `${teamsCount} nazionali`;
  document.getElementById('sq-sub').textContent = `${teamsCount} nazionali ¬∑ ${fasceCount} fasce`;

  const now = new Date().toLocaleTimeString('it-IT',{hour:'2-digit',minute:'2-digit'});
  if (isDemo) {
    document.getElementById('bot-bar').innerHTML =
      `<span style="color:var(--acc);font-weight:600">‚ö†Ô∏è DEMO ‚Äî Collega il tuo Google Sheet per dati reali</span>`;
  } else {
    document.getElementById('bot-bar').innerHTML =
      `<span class="live-dot"></span><span id="bot-txt">Aggiornato alle ${now}</span>`;
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TABS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(tab.dataset.tab).classList.add('active');
  });
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT + AUTO REFRESH
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
loadData();
setInterval(() => { if(!isDemo) loadData(); }, CFG.refresh * 1000);

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PWA ‚Äî SERVICE WORKER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('./sw.js')
      .then(reg => console.log('[GeppoCup] SW registrato:', reg.scope))
      .catch(err => console.warn('[GeppoCup] SW fallito:', err));
  });
}
</script>
</body>
</html>
